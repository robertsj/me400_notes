
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Lecture 18 - SymPy: Symbols, Expressions, and Equations. &#8212; ME 400 Course Notes Fall 2017 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'Fall 2017',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lecture 19 - Symbolic Calculus with SymPy" href="ME400_Lecture_19.html" />
    <link rel="prev" title="Lecture 17 - Unit Tests and Defensive Programming" href="ME400_Lecture_17.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="section" id="Lecture-18---SymPy:-Symbols,-Expressions,-and-Equations.">
<h1>Lecture 18 - SymPy: Symbols, Expressions, and Equations.<a class="headerlink" href="#Lecture-18---SymPy:-Symbols,-Expressions,-and-Equations." title="Permalink to this headline">¶</a></h1>
<div class="section" id="Overview,-Objectives,-and-Key-Terms">
<h2>Overview, Objectives, and Key Terms<a class="headerlink" href="#Overview,-Objectives,-and-Key-Terms" title="Permalink to this headline">¶</a></h2>
<p>From <a class="reference internal" href="ME400_Lecture_7.html"><span class="doc">Lecture 1</span></a> through <a class="reference internal" href="ME400_Lecture_17.html"><span class="doc">Lecture
17</span></a>, the focus has been squarely on the
fundamentals of programming, with some basic numerical tools (like
numerical arrays and plotting) and best practices (like unit testing)
included along the way. This lecture marks a transition to new topics
that will leverage the material already covered and provide students
with tools for solving difficult analytical or numerical problems common
to upper-level engineering courses. In particular, the SymPy module will
be used to define <em>symbols</em> and <em>symbolic expressions</em>, leading to a
very different (but very useful) tool for the engineer’s toolbox.</p>
<div class="section" id="Objectives">
<h3>Objectives<a class="headerlink" href="#Objectives" title="Permalink to this headline">¶</a></h3>
<p>By the end of this lesson, you should be able to</p>
<ul class="simple">
<li>Define symbols and symbolic expressions using SymPy</li>
<li>Define and solve systems of symbolic equations</li>
<li>Manipulate expressions by applying simplification and other symbolic
tools.</li>
</ul>
</div>
<div class="section" id="Key-Terms">
<h3>Key Terms<a class="headerlink" href="#Key-Terms" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">sympy</span></code></li>
<li><code class="docutils literal"><span class="pre">sympy.Symbol</span></code></li>
<li><code class="docutils literal"><span class="pre">sympy.symbols</span></code></li>
<li><code class="docutils literal"><span class="pre">sympy.init_printing</span></code></li>
<li><code class="docutils literal"><span class="pre">sympy.solve</span></code></li>
<li><code class="docutils literal"><span class="pre">sympy.evalf</span></code></li>
<li><code class="docutils literal"><span class="pre">sympy.simplify</span></code></li>
<li><code class="docutils literal"><span class="pre">sympy.expand</span></code></li>
<li><code class="docutils literal"><span class="pre">sympy.collect</span></code></li>
</ul>
</div>
</div>
<div class="section" id="Symbols">
<h2>Symbols<a class="headerlink" href="#Symbols" title="Permalink to this headline">¶</a></h2>
<p>Symbolic computation, as the name suggests, depends on <em>symbols</em>. Unlike
numerical computation, in which one manipulates <em>values</em>, symbolic
computations involves the manipulation of symbols. That’s just like when
you made the jump from grade-school number crunching to algebra for the
first time. Now, we get to do it again (for, I hope, more interesting
problems and with the help of Python).</p>
<p>Start by importing SymPy (using <code class="docutils literal"><span class="pre">sp</span></code> as an abbreviation) as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="kn">as</span> <span class="nn">sp</span>
</pre></div>
</div>
</div>
<p>A symbol can be defined using the <code class="docutils literal"><span class="pre">Symbol</span></code> function, whose single
argument is a string representing the name of the symbol. For example,
the symbol <span class="math">\(x\)</span> can be defined by</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[2]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>x
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[3]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>sympy.core.symbol.Symbol
</pre></div>
</div>
</div>
<p>That was easy. We could do the same thing for <span class="math">\(x\)</span>, <span class="math">\(y\)</span>, and
<span class="math">\(z\)</span>, but an all-in-one approach is</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y z&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>SymPy does not require that the string given to <code class="docutils literal"><span class="pre">Symbol</span></code> or
<code class="docutils literal"><span class="pre">symbols</span></code> matches in any meaningful way to the name to which the
symbol is assigned. For example, one could (but should <em>not</em>) do</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">v</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="n">v</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[5]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>u
</pre></div>
</div>
</div>
<p>Such naming, of course, could lead to confusion, bugs, etc.</p>
</div>
<div class="section" id="Nicer-Output">
<h2>Nicer Output<a class="headerlink" href="#Nicer-Output" title="Permalink to this headline">¶</a></h2>
<p>When a mathematical symbol is defined, it is often given a special font,
e.g., “x” would be typeset as <span class="math">\(x\)</span> and not <code class="docutils literal"><span class="pre">x</span></code>. SymPy provides a
way to get nicer output in IPython consoles and Jupyter notebooks. One
just needs to do</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">sp</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Note how the output of <code class="docutils literal"><span class="pre">x</span></code> changes slightly:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$x$$</div></div>
</div>
<p>This nicely typeset format will be very useful for reading and
understanding complex, symbolic expressions. In fact, it supports some
pretty neat formatting features. For example, a symbol like <span class="math">\(x_0\)</span>
is often used to represent an initial value for some quantity <span class="math">\(x\)</span>.
We might express that in Python as <code class="docutils literal"><span class="pre">x0</span></code> or <code class="docutils literal"><span class="pre">x_0</span></code>. In SymPy, both
styles work:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">x0</span><span class="p">,</span> <span class="n">y_0</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x0  y_0&#39;</span><span class="p">)</span>
<span class="n">x0</span><span class="p">,</span> <span class="n">y_0</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$\left ( x_{0}, \quad y_{0}\right )$$</div></div>
</div>
<p>Actually, this output not only confirms that subscripts can be formatted
as expected, but it shows that SymPy <code class="docutils literal"><span class="pre">symbol</span></code> can be placed in
containers like any other Python type.</p>
</div>
<div class="section" id="Symbolic-Expressions">
<h2>Symbolic Expressions<a class="headerlink" href="#Symbolic-Expressions" title="Permalink to this headline">¶</a></h2>
<p>We can use symbols to define mathematical expressions. For instance, we
know that the total energy of a system is given by its (relativistic)
mass times the speed of light squared, i.e.,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">m</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;m c&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$c^{2} m$$</div></div>
</div>
<p>Notice that the expression’s order was changed. The particular order of
symbols in the stored expression may differ from the expression
originally entered.</p>
<p>When storing expressions, Sympy often performs simplification
automatically, e.g.,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$x^{4}$$</div></div>
</div>
<p>but not always, e.g.,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$x \left(x + 2\right)$$</div></div>
</div>
<p>Just as one can assign the result of evaluated expressions (e.g.,
<code class="docutils literal"><span class="pre">2**3</span></code>) to a variable name, so too, can symbolic expressions be
assigned. For example, we can define</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">E</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span>
<span class="n">E</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$c^{2} m$$</div></div>
</div>
<p>However, now <code class="docutils literal"><span class="pre">E</span></code> is a symbolic variable (here, a
<code class="docutils literal"><span class="pre">sympy.core.mul.Mul</span></code>, but that’s just a detail) and can be manipulated
just like any other symbol, e.g.,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">E</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$c^{4} m^{2}$$</div></div>
</div>
<p>In many cases, we wish to do a sequence of symbolic computations before
substituting numerical value. We know, for example, that the speed of
light is about 300 million meters per second, and we can substitute that
value in <span class="math">\(c\)</span> by</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">E</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mf">3e8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$9.0 \cdot 10^{16} m$$</div></div>
</div>
<p>Note that this does <em>not</em> change the original expression:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">E</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$c^{2} m$$</div></div>
</div>
<p>To save the result of the substitution, one needs to assign it to a new
name, e.g.,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">Esub</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mf">3e8</span><span class="p">)</span>
<span class="n">Esub</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$9.0 \cdot 10^{16} m$$</div></div>
</div>
<p>You may (or may not) recall that the relativistic mass is given by
<span class="math">\(m = m_0 / \sqrt{1+(c/v)^2}\)</span>, where <span class="math">\(m_0\)</span> is the rest mass
of an object and <span class="math">\(v\)</span> is the magnitude of its velocity. We can
substitute this, too, via</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">m_0</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;m_0 v&#39;</span><span class="p">)</span>
<span class="n">E</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">m</span><span class="p">:</span><span class="n">m_0</span><span class="o">/</span><span class="n">sp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="n">v</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">c</span><span class="p">:</span><span class="mf">3e8</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$\frac{9.0 \cdot 10^{16} m_{0}}{\sqrt{\frac{c^{2}}{v^{2}} + 1}}$$</div></div>
</div>
<p>Note three things. First, the argument to <code class="docutils literal"><span class="pre">E.subs</span></code> is a dictionary,
with keys equal to the symbols being replaced and values equal to what
is being added in place of those keys. Second, the function <code class="docutils literal"><span class="pre">sp.sqrt</span></code>
has been used. Only symbolic functions (in the <code class="docutils literal"><span class="pre">sympy</span></code> module) should
generally be used in symbolic expressions. Third, <span class="math">\(c\)</span> appears in
the denominator even though we attempted to substitute its numerical
value. The solution is to use <em>chained substitution</em>, e.g.,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">E</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">m</span><span class="p">:</span> <span class="n">m_0</span><span class="o">/</span><span class="n">sp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="n">v</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)})</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">c</span><span class="p">:</span> <span class="mf">3e8</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$\frac{9.0 \cdot 10^{16} m_{0}}{\sqrt{1 + \frac{1}{v^{2}} 9.0 \cdot 10^{16}}}$$</div></div>
</div>
</div>
<div class="section" id="Symbolic-Equations">
<h2>Symbolic Equations<a class="headerlink" href="#Symbolic-Equations" title="Permalink to this headline">¶</a></h2>
<p>From above, we saw that symbolic expressions can be assigned to a name,
e.g., <span class="math">\(E=mc^2\)</span>. That would, at first glance, appear to be an
equation. However, in the world of SymPy, equations are defined by use
of the function <span class="math">\(Eq\)</span>. For example, we could define the following
equation:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a b x y&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$a x = b y$$</div></div>
</div>
<p>and we could actually assign that equation a name via</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">eq1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Suppose we would like to solve for <code class="docutils literal"><span class="pre">y</span></code> in terms of <code class="docutils literal"><span class="pre">x</span></code>. With SymPy,
we could do</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">eq1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$\left [ \frac{b y}{a}\right ]$$</div></div>
</div>
<p>The result is what we expect, and it is returned as the single element
of a list.</p>
<p>If we forgot to specify the variable for which we want a solution, we
find</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">eq1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$\left [ \left \{ a : \frac{b y}{x}\right \}\right ]$$</div></div>
</div>
<p>Here, the solution is a list also with one element, and that element is
a dictionary. Apparently, <code class="docutils literal"><span class="pre">sp.solve</span></code> solved for <span class="math">\(a\)</span>, but why?
Consider the following:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">*</span><span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$\left [ \left \{ b : \frac{c x}{y}\right \}\right ]$$</div></div>
</div>
<p>This suggests (but does not prove) that the solution is by default in
alphabetical order, and if one does not specify the variables to solve.
Therefore, a good rule of thumb is always to specify which variable is
to be found by <code class="docutils literal"><span class="pre">solve</span></code>.</p>
<blockquote>
<div><strong>Note</strong>: Always specify the names of variables to be solved.</div></blockquote>
<p>More information can be found on <code class="docutils literal"><span class="pre">sp.solve</span></code> by calling
<code class="docutils literal"><span class="pre">help(sp.solve)</span></code>. The output is quite long, but the signature of
<code class="docutils literal"><span class="pre">sp.solve</span></code> is <code class="docutils literal"><span class="pre">sp.solve(f,</span> <span class="pre">*symbols,</span> <span class="pre">**flags)</span></code>. Here, <code class="docutils literal"><span class="pre">f</span></code> must be
(1) one equation (e.g., <code class="docutils literal"><span class="pre">sp.Eq(expr1,</span> <span class="pre">expr2)</span></code>), (2) one symbolic
expression <code class="docutils literal"><span class="pre">expr</span></code> (treated implicitly as <code class="docutils literal"><span class="pre">sp.Eq(expr,</span> <span class="pre">0)</span></code>, or (3) a
sequence (e.g., <code class="docutils literal"><span class="pre">list</span></code>) of such equations or expressions.</p>
<p>Notice that <code class="docutils literal"><span class="pre">*symbols</span></code> and <code class="docutils literal"><span class="pre">**flags</span></code> have the special <code class="docutils literal"><span class="pre">*</span></code> and
<code class="docutils literal"><span class="pre">**</span></code> characters discussed in <a class="reference internal" href="ME400_Lecture_13.html"><span class="doc">Lecture 13</span></a>.
Convention usually puts <code class="docutils literal"><span class="pre">*</span></code> with <code class="docutils literal"><span class="pre">*args</span></code> and <code class="docutils literal"><span class="pre">**</span></code> with
<code class="docutils literal"><span class="pre">**kwargs</span></code>. However, the meaning is the same: <code class="docutils literal"><span class="pre">*symbols</span></code> is a
sequence of position arguments that represent the symbols for which the
equations are to be solved, while <code class="docutils literal"><span class="pre">**flags</span></code> are named arguments that
(may) modify how <code class="docutils literal"><span class="pre">sp.solve</span></code> works.</p>
<p>Now, let us define the second equation:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">d</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="n">eq2</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<p>which, as you’ll note, is just an expression. When used in solvers, an
expression <code class="docutils literal"><span class="pre">expr</span></code> is equivalent to the equation <code class="docutils literal"><span class="pre">Eq(expr,</span> <span class="pre">0)</span></code>. We
can solve the two equations simultaneously via</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">([</span><span class="n">eq1</span><span class="p">,</span> <span class="n">eq2</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$\left \{ x : \frac{b}{a d - b c}, \quad y : \frac{a}{a d - b c}\right \}$$</div></div>
</div>
<p>Go ahead and verify this by hand, and then take a look to the full SymPy
tutorial (link below) to check out what sorts of equations (and sets of
equations) SymPy can solve.</p>
<blockquote>
<div><strong>Note</strong>: As with <em>any</em> function one uses from SymPy or other
modules, make sure that the return value is the expected result (in
terms not just of <em>value</em> but also <em>type</em>.</div></blockquote>
<p>In order to get comfortable with SymPy and solving symbolic equations,
tackle the following:</p>
<blockquote>
<div><p><strong>Exercise</strong>: Solve <span class="math">\(a x^2 + b + c = 0\)</span> for <span class="math">\(x\)</span>, and
name the solutions <span class="math">\(x_0\)</span> and <span class="math">\(x_1\)</span>.</p>
<p><strong>Exercise</strong>: Solve <span class="math">\(e^{ax} = b\)</span> for <span class="math">\(x\)</span>, and name the
solution <span class="math">\(x_0\)</span>. Substitute <span class="math">\(b = 2\)</span>, and name the result
<span class="math">\(x_1\)</span>.</p>
<p><strong>Exercise</strong>: Solve <span class="math">\(x - y = 1\)</span> and <span class="math">\(2x + y = 1\)</span> for
<span class="math">\(x\)</span> and <span class="math">\(y\)</span>.</p>
<p><strong>Exercise</strong>: Given <span class="math">\(3a + 4b + 7c + 11 = 0\)</span>,
<span class="math">\(5a + 3b + 3c + 4 = 0\)</span>, and <span class="math">\(7a + 13b + 5c + 9=0\)</span>, find
<span class="math">\(a\)</span>, <span class="math">\(b\)</span>, and <span class="math">\(c\)</span>.</p>
</div></blockquote>
</div>
<div class="section" id="Numerical-Evaluation">
<h2>Numerical Evaluation<a class="headerlink" href="#Numerical-Evaluation" title="Permalink to this headline">¶</a></h2>
<p>The solution of one equation or a system of equations, linear or
nonlinear, is generally not the end of one’s analysis. Often, the
ultimate goal is to produce a final, numerical answer, with all
problem-specific parameters substituted into the final result.</p>
<p>Consider the expression</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">expr</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="n">expr</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$\sin{\left (x^{3} \right )}$$</div></div>
</div>
<p>Suppose we substitute <span class="math">\(x = 3\)</span>, which can be done via</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">expr_sub</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
<span class="n">expr_sub</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$\sin{\left (27 \right )}$$</div></div>
</div>
<p>As clean as this is, it’s not a <em>number</em>. The trick is to use <code class="docutils literal"><span class="pre">evalf</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">expr_sub</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$0.956375928404503$$</div></div>
</div>
</div>
<div class="section" id="Other-Symbolic-Tools">
<h2>Other Symbolic Tools<a class="headerlink" href="#Other-Symbolic-Tools" title="Permalink to this headline">¶</a></h2>
<p>Consider the following example:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">expr</span> <span class="o">=</span> <span class="p">((</span><span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="n">sp</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">sp</span><span class="o">.</span><span class="n">sec</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">sp</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">expr</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$\frac{1}{\tan{\left (t \right )}} \left(\left(\sin{\left (t \right )} + \tan{\left (t \right )}\right)^{2} + \cos^{2}{\left (t \right )} - \sec^{2}{\left (t \right )}\right)$$</div></div>
</div>
<p>Nope. SymPy didn’t simplify what looks to be a fairly formidable
trigonometric expression. But then again, we didn’t tell it to do so.
How’s this?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$\frac{1 - \frac{\cos{\left (3 t \right )}}{\cos{\left (t \right )}}}{2 \sin{\left (t \right )}}$$</div></div>
</div>
<p>That’s a bit cleaner. Exactly what “simplest” means as SymPy does this
magic is not really concrete. In fact, SymPy does simplification via a
sort of <em>heuristic</em> optimization (an area of active research).</p>
<p>Another way to simplify (at least visually, perhaps) is to <code class="docutils literal"><span class="pre">collect</span></code>
additive terms of some expression. What does that mean? Suppose we
define</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">d</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="n">expr</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$\left(a x + b y\right)^{2} \left(c x + d y\right)$$</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">sp</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$a^{2} c x^{3} + a^{2} d x^{2} y + 2 a b c x^{2} y + 2 a b d x y^{2} + b^{2} c x y^{2} + b^{2} d y^{3}$$</div></div>
</div>
<p>where <code class="docutils literal"><span class="pre">expand</span></code> does exactly what its name suggests: it expands the
product of sums to individual sums. But gosh, that output is
complicated. Suppose we want to group together all terms with like
powers of <span class="math">\(x\)</span>. That’s where <code class="docutils literal"><span class="pre">collect</span></code> comes in:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">sp</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$a^{2} c x^{3} + b^{2} d y^{3} + x^{2} \left(a^{2} d y + 2 a b c y\right) + x \left(2 a b d y^{2} + b^{2} c y^{2}\right)$$</div></div>
</div>
<p>With <code class="docutils literal"><span class="pre">simplify</span></code>, <code class="docutils literal"><span class="pre">expand</span></code>, and <code class="docutils literal"><span class="pre">collect</span></code>, one has substantial
flexibility in manipulating expressions into forms more easily
understood or used.</p>
<p>Finally, it is often the case that we want to visuallize our symbolic
results graphically. How to plot something like <span class="math">\(\sin(x)\)</span>? Of
course, NumPy has arrays and its own <code class="docutils literal"><span class="pre">np.sin(x)</span></code> functions, but that
will not work if <code class="docutils literal"><span class="pre">x</span></code> is a symbol. Fortunately, SymPy has the function
<code class="docutils literal"><span class="pre">lambdify</span></code>, which will turn any symbolic expression into a <code class="docutils literal"><span class="pre">lambda</span></code>
function suitable for numerical evaluations (array-based or otherwise)
and, hence, plotting.</p>
<p>For example, convert the expression <code class="docutils literal"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">x**2</span></code> into a function:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="n">f_fun</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="n">f_fun</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$$4.0$$</div></div>
</div>
<p>Note something important: the original expression was named <code class="docutils literal"><span class="pre">f</span></code>. To
keep names straight, I recommend naming any <em>lambdified</em> expression
<code class="docutils literal"><span class="pre">f</span></code> in the form <code class="docutils literal"><span class="pre">f_fun</span></code> <code class="docutils literal"><span class="pre">f_lam</span></code> to indicate its use as a function.</p>
<p>The result works by default for <code class="docutils literal"><span class="pre">ndarrays</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">f_fun</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[37]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>array([1, 4, 9])
</pre></div>
</div>
</div>
<p>Use of <code class="docutils literal"><span class="pre">lambdify</span></code> is highly recommended for producing plots of
symbolic expressions. For example, the expressions <code class="docutils literal"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">x**2</span></code> and
<code class="docutils literal"><span class="pre">g</span> <span class="pre">=</span> <span class="pre">x**3</span></code> can be plotted as follows (pay close attention to the
naming convention and the cool <code class="docutils literal"><span class="pre">latex</span></code> trick):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="c1"># x is a symbol, but we&#39;ll need actual value to</span>
<span class="c1"># plot.  Here, x_plot indicates its purpose as the</span>
<span class="c1"># values of x to be used for plotting.</span>
<span class="n">x_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">f_plot</span> <span class="o">=</span> <span class="n">f_fun</span><span class="p">(</span><span class="n">x_plot</span><span class="p">)</span> <span class="c1"># x**2</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span>
<span class="n">g_fun</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
<span class="n">g_plot</span> <span class="o">=</span> <span class="n">g_fun</span><span class="p">(</span><span class="n">x_plot</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">f_plot</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;${}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">f</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span>  <span class="n">g_plot</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;${}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">g</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/lectures_ME400_Lecture_18_80_0.png" src="../_images/lectures_ME400_Lecture_18_80_0.png" />
</div>
</div>
<p>For those curious, here’s what that <code class="docutils literal"><span class="pre">latex</span></code> function does:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[39]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&#39;x^{2}&#39;
</pre></div>
</div>
</div>
</div>
<div class="section" id="Further-Reading">
<h2>Further Reading<a class="headerlink" href="#Further-Reading" title="Permalink to this headline">¶</a></h2>
<p>Much of what has been covered here is drawn from the <a class="reference external" href="http://docs.sympy.org/latest/tutorial/index.html">SymPy
tutorial</a>. That’s a
great resource (as is the rest of the <a class="reference external" href="http://docs.sympy.org/latest/index.html">SymPy
documentation</a>. Because
SymPy is a relatively young module, you can expect it to be updated
rather frequently.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Lecture 18 - SymPy: Symbols, Expressions, and Equations.</a><ul>
<li><a class="reference internal" href="#Overview,-Objectives,-and-Key-Terms">Overview, Objectives, and Key Terms</a><ul>
<li><a class="reference internal" href="#Objectives">Objectives</a></li>
<li><a class="reference internal" href="#Key-Terms">Key Terms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Symbols">Symbols</a></li>
<li><a class="reference internal" href="#Nicer-Output">Nicer Output</a></li>
<li><a class="reference internal" href="#Symbolic-Expressions">Symbolic Expressions</a></li>
<li><a class="reference internal" href="#Symbolic-Equations">Symbolic Equations</a></li>
<li><a class="reference internal" href="#Numerical-Evaluation">Numerical Evaluation</a></li>
<li><a class="reference internal" href="#Other-Symbolic-Tools">Other Symbolic Tools</a></li>
<li><a class="reference internal" href="#Further-Reading">Further Reading</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="ME400_Lecture_17.html" title="previous chapter">Lecture 17 - Unit Tests and Defensive Programming</a></li>
      <li>Next: <a href="ME400_Lecture_19.html" title="next chapter">Lecture 19 - Symbolic Calculus with SymPy</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/lectures/ME400_Lecture_18.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Jeremy Roberts.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/lectures/ME400_Lecture_18.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>