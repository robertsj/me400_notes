<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Lecture 18 - Numerical Differentiation &mdash; ME 400 Course Notes Fall 2018 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'Fall 2018',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ME 400 Course Notes Fall 2018 documentation" href="../index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
<div class="section" id="Lecture-18---Numerical-Differentiation">
<h1>Lecture 18 - Numerical Differentiation<a class="headerlink" href="#Lecture-18---Numerical-Differentiation" title="Permalink to this headline">¶</a></h1>
<p>From <a class="reference external" href="ME400_Lecture_1.ipynb">Lecture 1</a> through <a class="reference external" href="ME400_Lecture_17.ipynb">Lecture
17</a>, the focus has been squarely on the
fundamentals of programming, with some basic numerical tools (like
numerical arrays and plotting) and best practices (like unit testing)
included along the way. Our focus now shifts to the use of programming
to solve problems <em>numerically</em>. We still need the basic tools we&#8217;ve
acquired (loops, functions, etc.), but our purpose is in <em>application</em>.
In this lesson, we&#8217;ll review the basics of Taylor series and how they
can be used to define <em>finite-difference</em> approximations for
derivatives. We&#8217;ll need these later in <a class="reference internal" href="Root_Finding.html"><span class="doc">Root
Finding</span></a> and <a class="reference internal" href="Numerical_Solution_of_BVPs.html"><span class="doc">Numerical Solution of
BVPs</span></a>.</p>
<div class="section" id="Objectives">
<h2>Objectives<a class="headerlink" href="#Objectives" title="Permalink to this headline">¶</a></h2>
<p>By the end of this lesson, you should be able to</p>
<ul class="simple">
<li>Derive finite-difference approximations for first- and second-order
derivatives using Taylor series.</li>
<li>Numerically/graphically demonstrate that the error of an
<span class="math">\(n\)</span>th-order approximation as <span class="math">\(\Delta \to 0\)</span> exhibits
the right behavior.</li>
<li>Evaluate derivatives numerically</li>
</ul>
<p>We&#8217;ll discuss the exam at the end (not turned back today)</p>
<div class="section" id="If,-in-the-beginning,--didn't-go-to-0...">
<h3>If, in the beginning, <span class="math">\(\Delta\)</span> didn&#8217;t go to 0...<a class="headerlink" href="#If,-in-the-beginning,--didn't-go-to-0..." title="Permalink to this headline">¶</a></h3>
<p>Recall that the derivative of <span class="math">\(f(x)\)</span> can be defined as</p>
<div class="math">
\[\frac{df}{dx} = \lim_{\Delta \to 0} \frac{f(x+\Delta)-f(x)}{\Delta} \, .\]</div>
<p>What if that limit is not taken and, instead, a &#8220;small&#8221; value of
<span class="math">\(\Delta\)</span> is used?</p>
<p>The result is our first <strong>finite-difference</strong> approximation, the
<strong>forward difference</strong>:</p>
<div class="math">
\[f'(x) \approx  \frac{f(x+\Delta)-f(x)}{\Delta} \, .\]</div>
<p>An equally valid approximation is the <strong>backward difference</strong>:</p>
<div class="math">
\[f'(x) \approx  \frac{f(x)-f(x-\Delta)}{\Delta} \, .\]</div>
<p><strong>Exercise</strong>: Show that the backward difference correctly differentiates
<span class="math">\(f(x) = ax^2 + bx + c\)</span> in the limit that <span class="math">\(\Delta \to 0\)</span>.</p>
<p><strong>Example</strong>: A rocket&#8217;s velocity is described by</p>
<div class="math">
\[v(t) = 2000 \ln \frac{10^{5}}{10^{5}-1500t} - 10t \, \quad t \in [0, 20~\text{s}]\]</div>
<p>Use the <em>backward difference</em> approximation with <span class="math">\(\Delta = 2\)</span>
seconds to estimate the acceleration at <span class="math">\(t = 10\)</span> s. What is the
<em>absolute error</em> in this approximation?</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">v</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Velocity of rocket (m/s) as a function of time.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">2000</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1e5</span><span class="o">/</span><span class="p">(</span><span class="mf">1e5</span><span class="o">-</span><span class="mi">1500</span><span class="o">*</span><span class="n">t</span><span class="p">))</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">t</span>

<span class="n">a_10_approx</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">a_10_ref</span> <span class="o">=</span> <span class="bp">None</span> <span class="c1"># remember your chain rule...</span>
</pre></div>
</div>
</div>
<p><strong>Exercise</strong>: How does that error behave for <span class="math">\(\Delta = 1\)</span>?
<span class="math">\(\Delta = 0.5\)</span>?</p>
</div>
<div class="section" id="Better-Approximations-via-Taylor-Series">
<h3>Better Approximations via Taylor Series<a class="headerlink" href="#Better-Approximations-via-Taylor-Series" title="Permalink to this headline">¶</a></h3>
<p>Formally,</p>
<div class="math">
\[\begin{split}\begin{split}
  f(x+\Delta)
   &amp;= f(x) + f'(x)\Delta + \frac{1}{2}f''(x)\Delta^2 + \sum^{\infty}_{n=3} \frac{f^{(n)}}{n!} \Delta^n \\
   &amp;= f(x) + f'(x)\Delta + \frac{1}{2}f''(x)\Delta^2 + \mathcal{O}(\Delta^3) \, .
\end{split}\end{split}\]</div>
<div class="line-block">
<div class="line">Note: - <span class="math">\(\mathcal{O}(\Delta^n)\)</span> represents any and all terms
proportional to <span class="math">\(\Delta^n\)</span> or higher powers of <span class="math">\(\Delta\)</span>.</div>
<div class="line">- Often, terms represented by <span class="math">\(\mathcal{O}(\Delta^n)\)</span> are called
&#8220;order <span class="math">\(n\)</span>&#8221; terms or are said to be &#8220;order <span class="math">\(n\)</span>&#8221;.</div>
</div>
<p><strong>Example</strong>: What <em>order</em> is the error of the forward difference method?</p>
<p><strong>Example</strong>: Expand both <span class="math">\(f(x+\Delta)\)</span> and <span class="math">\(f(x-\Delta)\)</span>
about <span class="math">\(x\)</span> and find an approximation for <span class="math">\(\frac{d f}{dx}\)</span>
that is second order.</p>
<p><strong>Example</strong>: Expand both <span class="math">\(f(x+\Delta)\)</span> and <span class="math">\(f(x-\Delta)\)</span>
about <span class="math">\(x\)</span> and find an approximation for <span class="math">\(\frac{d^2 f}{dx^2}\)</span>
that is second order.</p>
</div>
<div class="section" id="Putting-it-altogether">
<h3>Putting it altogether<a class="headerlink" href="#Putting-it-altogether" title="Permalink to this headline">¶</a></h3>
<p>See Canvas!</p>
</div>
<div class="section" id="Recap">
<h3>Recap<a class="headerlink" href="#Recap" title="Permalink to this headline">¶</a></h3>
<p>You should now be able to</p>
<ul class="simple">
<li>Derive finite-difference approximations for first- and second-order
derivatives using Taylor series.</li>
<li>Numerically/graphically/symbolically demonstrate that the error of an
<span class="math">\(n\)</span>th-order approximation as <span class="math">\(\Delta \to 0\)</span> exhibits
the right behavior.</li>
<li>Evaluate derivatives numerically</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Lecture 18 - Numerical Differentiation</a><ul>
<li><a class="reference internal" href="#Objectives">Objectives</a><ul>
<li><a class="reference internal" href="#If,-in-the-beginning,--didn't-go-to-0...">If, in the beginning, <span class="math">\(\Delta\)</span> didn&#8217;t go to 0...</a></li>
<li><a class="reference internal" href="#Better-Approximations-via-Taylor-Series">Better Approximations via Taylor Series</a></li>
<li><a class="reference internal" href="#Putting-it-altogether">Putting it altogether</a></li>
<li><a class="reference internal" href="#Recap">Recap</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/lectures/ME400_Lecture_18_Slides.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Jeremy Roberts.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/lectures/ME400_Lecture_18_Slides.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>