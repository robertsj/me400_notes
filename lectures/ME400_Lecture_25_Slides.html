<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Lecture 25 - Solving First-Order IVPs Numerically &mdash; ME 400 Course Notes Fall 2018 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'Fall 2018',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ME 400 Course Notes Fall 2018 documentation" href="../index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
<div class="section" id="Lecture-25---Solving-First-Order-IVPs-Numerically">
<h1>Lecture 25 - Solving First-Order IVPs Numerically<a class="headerlink" href="#Lecture-25---Solving-First-Order-IVPs-Numerically" title="Permalink to this headline">¶</a></h1>
<p><strong>Last Time</strong>: Interpolation</p>
<p><strong>Today</strong>: Initial Value Problems (IVPs)</p>
<div class="section" id="Objectives">
<h2>Objectives<a class="headerlink" href="#Objectives" title="Permalink to this headline">¶</a></h2>
<p>By the end of this lesson, you should be able to</p>
<ul class="simple">
<li>Define an appropriate differential equation to model an engineering
process</li>
<li>Apply forward and backward differences to produce forward and
backward Euler</li>
<li>Solve IVPs numerically to produce solutions at several time steps</li>
</ul>
</div>
<div class="section" id="Prerequisites">
<h2>Prerequisites<a class="headerlink" href="#Prerequisites" title="Permalink to this headline">¶</a></h2>
<p>You should already be able to</p>
<ul class="simple">
<li>Solve ODEs based on what you&#8217;ve learned in a course like MATH 340</li>
<li>Name your favorite differential equation from physics (if you&#8217;re
drawing a blank, remember <span class="math">\(F=m\frac{d^ 2 x}{dt^2}\)</span>)</li>
<li>Compute a first-order, finite-difference approximation for
<span class="math">\(\frac{df}{dx}\)</span></li>
</ul>
</div>
<div class="section" id="Key-Terms">
<h2>Key Terms<a class="headerlink" href="#Key-Terms" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Euler&#8217;s method</li>
<li>forward Euler</li>
<li>backward Euler</li>
<li>local error</li>
<li>global error</li>
</ul>
<div class="section" id="The-General-Problem">
<h3>The General Problem<a class="headerlink" href="#The-General-Problem" title="Permalink to this headline">¶</a></h3>
<p>Our goal is to solve the initial value problem (IVP):</p>
<div class="math">
\[\frac{dy}{dt} = f(y(t), t) \qquad y(0) = y_0 \, .\]</div>
<p>Today, just single IVPs. Next time, systems of IVPs.</p>
</div>
<div class="section" id="There-Once-was-a-Man-Named-Euler">
<h3>There Once was a Man Named Euler<a class="headerlink" href="#There-Once-was-a-Man-Named-Euler" title="Permalink to this headline">¶</a></h3>
<div class="figure" id="id1">
<img alt="Euler's grave in St. Petersburg" src="http://farm2.static.flickr.com/1085/1270449525_4b4b973a27_o.jpg" />
<p class="caption"><span class="caption-text">Euler&#8217;s grave in St. Petersburg</span></p>
</div>
<p>Recall the forward and backward difference approximations:</p>
<div class="math">
\[\frac{dy}{dt} \approx \frac{y(t+\Delta)-y(t)}{\Delta} \qquad \text{and} \qquad
\frac{dy}{dt} \approx \frac{y(t)-y(t-\Delta)}{\Delta}\]</div>
<p>Substitute forward difference into <span class="math">\(y' = f(y(t), t)\)</span> to get</p>
<div class="math">
\[\frac{y(t+\Delta)-y(t)}{\Delta} = f(y(t), t) + \mathcal{O}(\Delta)\]</div>
<p>or</p>
<div class="math">
\[y(t+\Delta) = \Delta f(y(t), t) + y(t)  + \mathcal{O}(\Delta^2)\]</div>
<p>Drop the error term to get the one-step <strong>forward Euler approximation</strong></p>
<div class="math">
\[\boxed{y(t+\Delta) \approx \Delta f(y(t), t) + y(t)}\]</div>
<p>Do the same with the backward difference to get</p>
<div class="math">
\[\frac{y(\tau)-y(\tau-\Delta)}{\Delta} = f(y(\tau), \tau) + \mathcal{O}(\Delta)\]</div>
<p>and let <span class="math">\(\tau = t+\Delta\)</span> to get the one-step <strong>backward Euler
approximation</strong>:</p>
<div class="math">
\[\boxed{ y(t+\Delta) \approx \Delta f(y(t+\Delta), t+\Delta) + y(t+\Delta)}\]</div>
<p><strong>Exercise</strong>: Consider <span class="math">\(y' = \sqrt{y(t)} + 2\)</span> with
<span class="math">\(y(0) = 1\)</span>. Use one step of the <em>forward Euler method</em> to estimate
<span class="math">\(y(0.1)\)</span>. Do this <em>by hand</em>.</p>
<p><strong>Exercise</strong>: Consider <span class="math">\(y' = \sqrt{y(t)} + 2\)</span> with
<span class="math">\(y(0) = 1\)</span>. Use one step of the <em>backward Euler method</em> to
estimate <span class="math">\(y(0.1)\)</span>. Do this <em>by hand</em>.</p>
</div>
<div class="section" id="Chopping-Up-Time">
<h3>Chopping Up Time<a class="headerlink" href="#Chopping-Up-Time" title="Permalink to this headline">¶</a></h3>
<p>We&#8217;ll approximate <span class="math">\(y(t)\)</span> at discrete times
<span class="math">\(t_0,\, t_1,\, t_2,\, \ldots\)</span>, or</p>
<div class="math">
\[y_n = y(t_n) \qquad  t_n = t_0 + n\Delta \qquad n = 0, 1, \ldots \, .\]</div>
<p>Apply Euler&#8217;s method to go from <span class="math">\(y_n\)</span> to <span class="math">\(y_{n+1}\)</span>:</p>
<div class="math">
\[\text{forward Euler} \qquad  \boxed{y_{n+1} =  \Delta f(y_n, t_n) + y_n \, , \qquad n = 0, 1, 2, \ldots}\]</div>
<div class="math">
\[\text{backward Euler} \qquad \boxed{y_{n+1}  = \Delta f(y_{n+1}, t_{n+1}) + y_n \, , \qquad n = 0, 1, 2, \ldots}\]</div>
<p><strong>Exercise</strong>: Given <span class="math">\(y' = -2y(t) + 1\)</span> with <span class="math">\(y(0) = 0\)</span>, use
forward Euler to estimate <span class="math">\(y(10)\)</span> for <span class="math">\(\Delta = 0.2\)</span>,
<span class="math">\(0.1\)</span>, and <span class="math">\(0.05\)</span>. What happens to the error?</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">y_10</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="p">))</span> <span class="c1"># true value</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Application-Problem---Transferring-Wort">
<h3>Application Problem - Transferring Wort<a class="headerlink" href="#Application-Problem---Transferring-Wort" title="Permalink to this headline">¶</a></h3>
<p>Consider a cylindrical tank 2.5 m tall with a radius of 1.25 m filled
with wort (a magical concoction of water, barley, and hops&#8211;no fruit,
please). At the bottom of this tank is a drain that opens to a flow area
of 0.0025 m<span class="math">\(^2\)</span>. At time <span class="math">\(t = 0\)</span>, the drain is manually
opened such that its open flow area follows the form</p>
<div class="math">
\[\begin{split}a_{drain}(t) =
\begin{cases}
   0.0025 \frac{t^2}{25} &amp; t \leq 5 \, \text{s} \\
   0.0025 &amp; t &gt; 5\, \text{s} \, .
\end{cases}\end{split}\]</div>
<p>In other words, it takes some time to get that drain open, but it
becomes easier to open with time until it fully opens (not unrealistic
methinks). <strong>How long does it take to get my wort out of the tank?</strong></p>
</div>
</div>
<div class="section" id="Getting-the-IVP">
<h2>Getting the IVP<a class="headerlink" href="#Getting-the-IVP" title="Permalink to this headline">¶</a></h2>
<p><strong>Assume</strong> the fluid is <em>incompressible</em> (i.e., <span class="math">\(\rho\)</span> is
constant) and that gravity is the only thing driving this process.</p>
<p>Equations of interest (from thermodynamics and/or fluid dynamics):</p>
<div class="math">
\[\text{conservation of mass:} \qquad  \rho a V = \text{constant}\]</div>
<p>and</p>
<div class="math">
\[\text{conservation of energy:} \qquad \frac{V^2}{2} + gz = \text{constant}\]</div>
<p>where <span class="math">\(V\)</span> is velocity, <span class="math">\(a\)</span> is a flow area, <span class="math">\(z\)</span> is
height, and <span class="math">\(g\)</span> is gravitational acceleration (9.81
m/s<span class="math">\(^2\)</span>).</p>
<p>Then conservation of energy gives</p>
<div class="math">
\[\frac{V_{top}^2-V_{drain}^2}{2} + g \overbrace{(z_{top}-z_{bottom})}^{h} = 0 \, .\]</div>
<p><strong>Assume</strong> that <span class="math">\(V_{top} \ll V_{drain}\)</span> so that
<span class="math">\(\boxed{V_{drain} = \sqrt{2gh(t)}}\)</span> where <span class="math">\(h(t)\)</span> will vary
with time.</p>
<p>Conservation of mass gives</p>
<div class="math">
\[\begin{split}\begin{split}
   \frac{d m_{drain}}{dt} \Delta t &amp;= \frac{d m_{top}}{dt} \Delta t \\
   \rho V_{drain}(t) a_{drain}(t) \Delta t &amp;= \rho a_{top} \left(-\frac{dh}{dt}\right ) \Delta t \, .
\end{split}\end{split}\]</div>
<p>or</p>
<div class="math">
\[\boxed{\frac{dh}{dt} = -\frac{a_{drain}(t)}{a_{top}} \sqrt{2gh(t)}}\]</div>
<p>Solve this with <strong>backward Euler</strong>.</p>
</div>
<div class="section" id="Connecting-the-Dots">
<h2>Connecting the Dots<a class="headerlink" href="#Connecting-the-Dots" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>What if this were not a cylinder but a cone (i.e., a tapered funnel)?
Or something more complicated? How would you modify the equation?</li>
<li>Suppose you were to design a tank like the one we analyzed that has
to fit in some finite volume. How would you optimize its geometry to
provide the fast drainage possible given a fixed drain flow area?</li>
</ul>
<div class="section" id="Recap">
<h3>Recap<a class="headerlink" href="#Recap" title="Permalink to this headline">¶</a></h3>
<p>You should now be able to</p>
<ul class="simple">
<li>Define an appropriate differential equation to model an engineering
process</li>
<li>Apply forward and backward differences to produce forward and
backward Euler</li>
<li>Solve IVPs numerically to produce solutions at several time steps</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Lecture 25 - Solving First-Order IVPs Numerically</a><ul>
<li><a class="reference internal" href="#Objectives">Objectives</a></li>
<li><a class="reference internal" href="#Prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#Key-Terms">Key Terms</a><ul>
<li><a class="reference internal" href="#The-General-Problem">The General Problem</a></li>
<li><a class="reference internal" href="#There-Once-was-a-Man-Named-Euler">There Once was a Man Named Euler</a></li>
<li><a class="reference internal" href="#Chopping-Up-Time">Chopping Up Time</a></li>
<li><a class="reference internal" href="#Application-Problem---Transferring-Wort">Application Problem - Transferring Wort</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Getting-the-IVP">Getting the IVP</a></li>
<li><a class="reference internal" href="#Connecting-the-Dots">Connecting the Dots</a><ul>
<li><a class="reference internal" href="#Recap">Recap</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/lectures/ME400_Lecture_25_Slides.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Jeremy Roberts.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/lectures/ME400_Lecture_25_Slides.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>